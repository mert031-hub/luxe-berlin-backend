<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LUXE BERLIN | Master Admin</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link
        href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&family=Playfair+Display:wght@700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="admin.css">
</head>

<body class="bg-light">

    <div id="preloader">
        <div class="preloader-content">
            <div class="preloader-logo">LUXE<span>BERLIN</span></div>
            <div class="preloader-bar"></div>
            <p class="preloader-text">Exklusive Administration wird geladen...</p>
        </div>
    </div>

    <nav class="navbar navbar-expand-lg navbar-dark sticky-top">
        <div class="container">
            <a class="navbar-brand fw-bold" href="#">LUXE<span>BERLIN</span> ADMIN</a>
            <div class="ms-auto d-flex align-items-center">
                <button class="btn btn-outline-warning btn-sm me-2" onclick="logout()">Abmelden</button>
                <a href="index.html" class="btn btn-outline-light btn-sm px-3 d-none d-sm-inline-block">Storefront</a>
            </div>
        </div>
    </nav>

    <main id="adminMainContent" class="container py-4 py-md-5 d-none">

        <div class="row g-4 mb-4 d-none" id="critical-stock-alert">
            <div class="col-12">
                <div class="alert alert-danger border-0 shadow-sm rounded-4 d-flex align-items-center mb-0 py-3">
                    <i class="fas fa-exclamation-triangle fa-2x me-3 animate-pulse"></i>
                    <div>
                        <h6 class="fw-bold mb-1">Kritischer Lagerbestand!</h6>
                        <p class="small mb-0 text-dark" id="low-stock-list"></p>
                    </div>
                </div>
            </div>
        </div>

        <div class="row g-3 g-md-4 mb-4 text-center text-white">
            <div class="col-6 col-md-4" data-aos="fade-up" data-aos-delay="100">
                <div class="stat-card bg-navy h-100">
                    <p>Bestellungen</p>
                    <h2 id="stat-count" class="fw-bold mb-0">0</h2>
                </div>
            </div>
            <div class="col-6 col-md-4" data-aos="fade-up" data-aos-delay="200">
                <div class="stat-card bg-gold h-100">
                    <p>Umsatz</p>
                    <h2 id="stat-revenue" class="fw-bold mb-0">0,00 ‚Ç¨</h2>
                </div>
            </div>
            <div class="col-12 col-md-4" data-aos="fade-up" data-aos-delay="300">
                <div class="stat-card bg-dark-grey h-100">
                    <p>Kunden</p>
                    <h2 id="stat-customers" class="fw-bold mb-0">0</h2>
                </div>
            </div>
        </div>

        <div class="row mb-4" data-aos="fade-up">
            <div class="col-lg-8 mb-4 mb-lg-0">
                <div class="card border-0 shadow-sm rounded-4 p-3 p-md-4 h-100">
                    <div
                        class="d-flex flex-column flex-md-row justify-content-between align-items-md-center mb-4 gap-3">
                        <h5 class="fw-bold mb-0 text-navy">üìà Umsatz & Volumen</h5>
                        <div class="btn-group btn-group-sm shadow-sm">
                            <button class="btn btn-outline-dark btn-chart-toggle px-3"
                                onclick="changeChartMode('daily')">Tag</button>
                            <button class="btn btn-outline-dark btn-chart-toggle px-3"
                                onclick="changeChartMode('weekly')">Woche</button>
                            <button class="btn btn-outline-dark btn-chart-toggle px-3 active" id="btn-monthly"
                                onclick="changeChartMode('monthly')">Monat</button>
                        </div>
                    </div>
                    <div style="height: 300px;"><canvas id="salesChart"></canvas></div>
                </div>
            </div>

            <div class="col-lg-4">
                <div class="card border-0 shadow-sm rounded-4 p-3 p-md-4 h-100">
                    <h5 class="fw-bold mb-4 text-navy">üìä Bestellstatus</h5>
                    <div style="height: 300px; position: relative;">
                        <canvas id="statusChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <div class="row g-4 mb-4" data-aos="fade-up">
            <div class="col-lg-7">
                <div class="card border-0 shadow-sm rounded-4 p-4 h-100">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h5 class="fw-bold mb-0 text-navy">üèÜ Top-Seller Produkte</h5>
                        <span
                            class="badge bg-gold-light text-gold px-3 py-2 rounded-pill small fw-bold">Best-Performance</span>
                    </div>
                    <div class="table-responsive">
                        <table class="table table-borderless align-middle mb-0">
                            <tbody id="top-products-list">
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div class="col-lg-5">
                <div
                    class="card border-0 shadow-sm rounded-4 p-4 h-100 bg-navy text-white position-relative overflow-hidden">
                    <div class="position-absolute top-0 end-0 p-3 opacity-25">
                        <i class="fas fa-chart-pie fa-5x"></i>
                    </div>
                    <h5 class="fw-bold mb-4">Schnellanalyse</h5>
                    <div class="mb-4">
                        <p class="small opacity-75 mb-1">Durchschnittlicher Bestellwert (AOV)</p>
                        <h3 id="stat-aov" class="fw-bold text-gold">0,00 ‚Ç¨</h3>
                    </div>
                    <hr class="opacity-25">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <span>Bestellungen heute</span>
                        <span class="badge bg-success px-3 py-2" id="today-order-count">0</span>
                    </div>
                    <button class="btn btn-gold w-100 rounded-pill mt-auto fw-bold py-2 shadow"
                        onclick="exportOrdersToCSV()">
                        <i class="fas fa-file-export me-2"></i> CSV Export (Bestellungen)
                    </button>
                </div>
            </div>
        </div>

        <div class="card border-0 shadow-sm rounded-4 mb-4" data-aos="fade-up">
            <div class="card-body p-3 p-md-4">
                <div class="d-flex flex-column flex-md-row justify-content-between align-items-md-center mb-4 gap-3">
                    <h4 class="fw-bold mb-0">Bestellungsverwaltung</h4>
                    <input type="text" id="orderSearch" class="form-control w-100 w-md-50 rounded-pill"
                        placeholder="Kunden suchen...">
                </div>
                <div class="table-scroll-container">
                    <table class="table table-hover align-middle mb-0">
                        <thead>
                            <tr>
                                <th>Datum</th>
                                <th>Kunde</th>
                                <th>Details</th>
                                <th>Zahlung</th>
                                <th>Betrag</th>
                                <th>Status</th>
                                <th class="text-end">Aktion</th>
                            </tr>
                        </thead>
                        <tbody id="admin-order-list"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <div class="card border-0 shadow-sm rounded-4 mb-4" data-aos="fade-up">
            <div class="card-body p-3 p-md-4">
                <div class="d-flex flex-column flex-md-row justify-content-between align-items-md-center mb-4 gap-3">
                    <h4 class="fw-bold mb-0">Rezensionen verwalten</h4>
                    <input type="text" id="reviewSearch" class="form-control w-100 w-md-50 rounded-pill"
                        placeholder="Rezensionen durchsuchen...">
                </div>
                <div class="table-scroll-container">
                    <table class="table table-hover align-middle mb-0">
                        <thead>
                            <tr>
                                <th>Datum</th>
                                <th>Name</th>
                                <th>Bewertung</th>
                                <th>Kommentar</th>
                                <th>Antwort</th>
                                <th class="text-end">Aktion</th>
                            </tr>
                        </thead>
                        <tbody id="admin-review-list"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <section class="row g-4 mb-4">
            <div class="col-lg-4 order-2 order-lg-1" data-aos="fade-right">
                <div class="card p-4 shadow-sm border-0 rounded-4 sticky-card">
                    <h5 id="productFormTitle" class="fw-bold mb-3 text-navy">Produkt verwalten</h5>
                    <form id="productForm">
                        <input type="hidden" id="pId">
                        <div class="mb-2"><input type="text" id="pName" class="form-control" placeholder="Produktname"
                                required></div>
                        <div class="mb-2"><input type="number" id="pPrice" class="form-control" placeholder="Preis (‚Ç¨)"
                                step="0.01" required></div>
                        <div class="mb-2">
                            <label class="small fw-bold opacity-75 mb-1 text-navy">Lagerbestand</label>
                            <input type="number" id="pStock" class="form-control" placeholder="Anzahl" min="0" required>
                        </div>
                        <div class="mb-2">
                            <label class="small fw-bold opacity-75 mb-1">Produktbild</label>
                            <input type="file" id="pImageFile" class="form-control" accept="image/*">
                        </div>
                        <div id="imagePreview" class="mb-3 text-center d-none"><img src="" id="previewImg" width="100"
                                class="rounded border shadow-sm"></div>
                        <div class="mb-3"><textarea id="pDesc" class="form-control" placeholder="Beschreibung" rows="3"
                                required></textarea></div>
                        <button type="submit" id="productSubmitBtn"
                            class="btn btn-dark w-100 rounded-pill">Speichern</button>
                        <button type="button" id="cancelEditBtn" class="btn btn-link btn-sm w-100 mt-2 d-none"
                            onclick="resetProductForm()">Abbrechen</button>
                    </form>
                </div>
            </div>

            <div class="col-lg-8 order-1 order-lg-2" data-aos="fade-left">
                <div class="card p-3 p-md-4 shadow-sm border-0 rounded-4 h-100">
                    <div
                        class="d-flex flex-column flex-md-row justify-content-between align-items-md-center mb-3 gap-3">
                        <h5 class="fw-bold mb-0">Inventar & Bestand</h5>
                        <input type="text" id="productSearch" class="form-control w-100 w-md-50 rounded-pill"
                            placeholder="Produkte suchen...">
                    </div>
                    <div class="table-scroll-container">
                        <table class="table align-middle mb-0">
                            <thead>
                                <tr>
                                    <th>Bild</th>
                                    <th>Name</th>
                                    <th>Preis</th>
                                    <th>Lager</th>
                                    <th class="text-end">Aktion</th>
                                </tr>
                            </thead>
                            <tbody id="admin-product-list"></tbody>
                        </table>
                    </div>
                    <div class="mt-5 pt-4 border-top">
                        <h6 class="fw-bold text-danger mb-3">üóëÔ∏è Archivierte Produkte</h6>
                        <div class="table-scroll-container" style="max-height: 200px;">
                            <table class="table table-sm align-middle mb-0">
                                <tbody id="admin-archived-list"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <div class="card border-0 shadow-sm rounded-4 mb-4" data-aos="fade-up">
            <div class="card-body p-3 p-md-4">
                <div class="d-flex flex-column flex-md-row justify-content-between align-items-md-center mb-3 gap-3">
                    <h5 class="fw-bold mb-0 text-navy">üñ•Ô∏è Aktivit√§tsprotokoll</h5>
                    <div class="input-group shadow-sm rounded-pill overflow-hidden" style="max-width: 350px;">
                        <span class="input-group-text bg-white border-end-0"><i
                                class="fas fa-search text-muted"></i></span>
                        <input type="text" id="logSearch" class="form-control border-start-0 ps-0"
                            placeholder="Admin veya aksiyon ara...">
                    </div>
                </div>
                <div class="table-scroll-container" style="max-height: 350px;">
                    <table class="table table-sm small mb-0 table-hover">
                        <thead class="bg-light sticky-log-header fw-bold">
                            <tr>
                                <th>Zeit</th>
                                <th>Aktion</th>
                                <th>User</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="admin-activity-logs"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <section class="row g-4 pt-5 border-top" data-aos="fade-up">
            <div class="col-lg-4">
                <div class="card p-4 shadow-sm border-0 rounded-4">
                    <h5 class="fw-bold mb-3">Admin hinzuf√ºgen</h5>
                    <form id="addAdminForm">
                        <input type="text" id="newAdminUser" class="form-control mb-2" placeholder="Benutzername"
                            required>
                        <input type="password" id="newAdminPass" class="form-control mb-3" placeholder="Passwort"
                            required>
                        <button type="submit" class="btn btn-dark w-100 rounded-pill">Registrieren</button>
                    </form>
                </div>
            </div>
            <div class="col-lg-8">
                <div class="card p-3 p-md-4 shadow-sm border-0 rounded-4 h-100">
                    <h5 class="fw-bold mb-3">Aktive Administratoren</h5>
                    <div class="table-scroll-container" style="max-height: 250px;">
                        <table class="table align-middle mb-0">
                            <tbody id="admin-list-body"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <div class="modal fade" id="statusConfirmModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content border-0 shadow-lg rounded-4 overflow-hidden">
                <div class="modal-body p-5 text-center">
                    <div class="status-icon-circle"><i class="fas fa-exchange-alt fa-2x"></i></div>
                    <h4 class="fw-bold mb-2">Status √§ndern?</h4>
                    <p class="text-muted small mb-4">M√∂chten Sie den Status ger√ßekten aktualisieren?</p>
                    <div
                        class="status-change-box d-flex align-items-center justify-content-center gap-3 mb-4 p-3 rounded-3">
                        <div class="text-center"><span
                                class="d-block small text-muted text-uppercase fw-bold">VON</span><span
                                id="modal-old-status" class="fw-bold text-navy">-</span></div>
                        <i class="fas fa-arrow-right text-gold"></i>
                        <div class="text-center"><span
                                class="d-block small text-muted text-uppercase fw-bold">ZU</span><span
                                id="modal-new-status" class="fw-bold text-gold">-</span></div>
                    </div>
                    <div class="d-flex gap-2">
                        <button type="button" class="btn btn-light w-100 rounded-pill fw-bold"
                            data-bs-dismiss="modal">Abbrechen</button>
                        <button type="button" id="confirmStatusBtn"
                            class="btn btn-gold w-100 rounded-pill fw-bold shadow-sm">Best√§tigen</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="orderDetailModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content border-0 shadow-lg rounded-4">
                <div class="modal-header bg-dark text-white">
                    <h5 class="modal-title fw-bold">Bestellungsdetails</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div id="modal-content-area" class="modal-body p-4"></div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="replyModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content border-0 shadow-lg rounded-4">
                <div class="modal-header text-white" style="background: #1c2541;">
                    <h5 class="modal-title">Antworten</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <input type="hidden" id="replyReviewId">
                    <label class="small fw-bold text-muted mb-2">Deine Antwort:</label>
                    <textarea id="adminReplyText" class="form-control" rows="4"
                        placeholder="Schreiben Sie..."></textarea>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-light" data-bs-dismiss="modal">Schlie√üen</button>
                    <button type="button" class="btn btn-gold px-4" onclick="submitReply()">Senden</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
    <script src="admin.js"></script>
</body>

</html>